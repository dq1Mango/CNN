<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Free Data!!!</title>
    <style>
    .center {
    position: absolute;
    margin: auto;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    border: 3px solid #0000ff;
    }

    .numbers {
    position: absolute;
    top: 0;
    left: 0;
    }
    .number {
    font-size: 32px;
    }

    </style>
  </head>

  <body>
    <main>
      <h1 id="title">Welcome to My Website</h1>
      <div id="test">
        <canvas id="canvas" class="center"></canvas>   
        <div id="numbers" class="numbers">
        <button type="button" class="number">1</button> 
        <br>
        <br>
        <button type="button" class="number">2</button> 
        <br>
        <br>
        <button type="button" class="number">3</button> 
        <br>
        <br>
        <button type="button" class="number">4</button> 
      </div>

      </div>
      
    </main>
  </body>

<script>

  const canvas = document.getElementById("canvas");

 //const rect = canvas.getBoundingClientRect();
 //canvas.width = rect.width * 4;
 //canvas.height = rect.height * 1;


// Set the "drawn" size of the canvas
//canvas.style.width = `${rect.width}px`;
//canvas.style.height = `${rect.height}px`;

  

  function getMousePos(canvas, evt) {
    var rect = canvas.getBoundingClientRect();
     return {
      x: evt.clientX - rect.left,
      y: evt.clientY - rect.top
    };
  }
  
  
  var array = new Array(64);

  for (var i = 0; i < 64; i++) {
    array[i] = new Array(64);
  }

  for (var i = 0; i < 64; i++) {
    for (var j = 0; j < 64; j++) {
      array[i][j] = false
    }
  }
  
  const title = document.getElementById("title")
  //D1 javascript-er
  width = window.innerWidth 
  margin = window.getComputedStyle(title).marginTop
  margin = parseInt(margin, 10) * 2
  //console.log("padding :", title.getBoundingClientRect().height)
  height = window.innerHeight - title.getBoundingClientRect().height - margin//yeah yeah ill fix it later
  //height = test.getBoundingClientRect().height
  
  canvas.style.top = margin
  
  

  size = Math.floor(height / 64)
  pad = height % 64 / 2
  console.log(size)

  canvas.width = size * 64;  
  canvas.height = size * 64;

  const numbers = document.getElementById("numbers")
  
  dimensions = canvas.getBoundingClientRect()
  //numbers.style.top = margin + 100
  console.log("ahh", dimensions.left + dimensions.width)
  //numbers.style.left = dimensions.left + dimensions.width
  

  const ctx = canvas.getContext("2d");
  //ctx.fillStyle = "green";
  //ctx.fillRect(0, 0, 64 * size, 64 * size)
  ctx.flllStyle = "black"
  //ctx.fillRect(63, 61, 373, 571)
  
  let drawing = false
  let thickness = 2
  let pastX = 0
  let pastY = 0
  canvas.addEventListener('mousedown', (event) => {
    console.log("real news")
    drawing = true
    drawBox(event.offsetX, event.offsetY)
  })
  document.addEventListener('mouseup', (event) => {
    drawing = false
    /*x = event.offsetX
    y = event.offsetY
    pastX = x
    pastY = y*/
  })

  function drawBox(x, y) {
    //console.log(x * size, y * size, (x + 1)* size - 1, (y + 1) * size - 1 )
    if (thickness % 2 == 1) {
      startX = x - size * Math.floor(thickness / 2)
      startY = y - size * Math.floor(thickness / 2)
    } else {
      startX = x - size * (1/2 + thickness / 2 - 1)
      startY = y - size * (1/2 + thickness / 2 - 1)
    }
    
    //console.log("starting at: ", startX, startY)
    for (let i = 0; i < thickness; i++) {
      for (let j = 0; j < thickness; j++) {
        const x = Math.floor((startX + size * i) / size);
        const y = Math.floor((startY + size * j) / size);
        
        if (x < 0 || x >= 64 || y < 0 || y >= 64) {
          continue
        }
        array[y][x] = true;
        
        //TODO: make perfomance better ;)
        ctx.fillRect(x * size, y * size, size, size)
      }
    }
    //console.log("drew")
  }
    
  
  canvas.addEventListener('mousemove', (event) => {
    if (! drawing) {
      return
    }
    const x = event.offsetX;
    const y = event.offsetY;

    console.log(x, y)

    drawBox(x, y) 
    
  });
 

 console.log(array)
</script>

</html>
